### ラボ 08A

Power BI Desktop でレポートを設計、パート 1

# 概要

**所要時間: 45 分**

このラボでは、**「売上レポート」** という名前の 3 ページのレポートを作成します。次に、Power BI に発行し、レポートを開いて操作します。

このラボでは、次の方法を学習します。

* Power BI Desktop を使用してライブ接続を作成する

* レポートを設計する

* ビジュアル フィールドとファイル形式プロパティの構成

# 演習 1: レポートを作成する

この演習では、**「売上レポート」** という名前の 3 ページのレポートを作成します。

### タスク 1: 新しいファイルの作成

このタスクでは、**営業分析**データセットへのライブ接続を作成します。

1. Power BI デスクトップを開くには、タスク バーで、Microsoft Power BI Desktop ショートカットをクリックします。

	![画像 2](Linked_image_Files/PowerBI_Lab08A_image1.png)

2. ようこそ画面の上部にある、「**X**」 をクリックします。

	![画像　1](Linked_image_Files/PowerBI_Lab08A_image2.png)

3. **「ファイル」** リボン タブをクリックして、バックステージ ビューを開き、**「保存」** を選択します。

	![画像 13](Linked_image_Files/PowerBI_Lab08A_image3.png)

4. **名前を付けて保存** ウィンドウで、**D:\DA100\MySolution** フォルダーに移動します。

5. **「ファイル名」** ボックスに、**「売上レポート」** と入力します。

	![画像 14](Linked_image_Files/PowerBI_Lab08A_image4.png)

6. 「**保存**」 をクリックします。

	![画像 17](Linked_image_Files/PowerBI_Lab08A_image5.png)

### タスク 2: ライブ接続を作成する

このタスクでは、**営業分析**データセットへのライブ接続を作成します。

1. ライブ接続を作成するには、**「ホーム」** リボン タブの **「データ」** グループ内で、**「データの取得」** をクリックし、下向き矢印をクリックして、**「Power BI データセット」** を選択します。

	![画像 6](Linked_image_Files/PowerBI_Lab08A_image6.png)

2. **レポートを作成するデータセットの選択** ウィンドウで、**「売上分析」** データセットを選択します。

	![画像 7](Linked_image_Files/PowerBI_Lab08A_image7.png)

3. 「**作成**」 をクリックします。

	![画像 9](Linked_image_Files/PowerBI_Lab08A_image8.png)

4. 右下のステータス バーで、ライブ接続が確立されていることに注目します。

5. **フィールド** ウィンドウで、データ モデル テーブルが一覧表示されていることを確認します。

	*Power BI Desktop は、データ モデルの開発に使用できなくなりました。ライブ接続モードでは、レポート作成ツールのみです。ただし、メジャーを作成することはできますが、レポート内でのみ使用できるメジャーです。このラボではレポート スコープのメジャーを追加しません*。

6. Power BI Desktop ファイルを保存します。

	***ラボ 05A** のモデルに **Salespeople** ロールを追加したことを思い出してください。Power BI データセットの所有者であるため、ロールは強制されません。このラボですべてのデータを確認できる理由を説明します*。

	* データセットの所有者以外のユーザーにレポートやダッシュボードを共有する場合、そのアカウント (またはメンバーであるセキュリティ グループ) は、**Salespeople** ロールにマップする必要があります。**ラボ 12A*** でコンテンツを共有する前に、これを設定します。

### タスク 3: デザイン ページ 1

このタスクでは、最初のページを設計します。設計が完了すると、ページは次のようになります。  
	![画像 40](Linked_image_Files/PowerBI_Lab08A_image9.png)

1. ページの名前を変更するには、左下の 「**ページ 1**」 を右クリックし、「**名前の変更**」 を選択します。   

	![画像 36](Linked_image_Files/PowerBI_Lab08A_image10.png)

	*ヒント: ページ名 をダブルクリックすることもできます*。

2. ページの名前を 「**概要**」 に変更し、「**Enter**」 キーを押します。   

	![画像 37](Linked_image_Files/PowerBI_Lab08A_image11.png)

3. イメージを追加するには、「**挿入**」 リボン タブの 「**要素**」 グループ内で、「**イメージ**」 をクリックします。     

	![画像 10](Linked_image_Files/PowerBI_Lab08A_image12.png)

4. 「**開く**」 ウィンドウで、**D:\DA100\Data** フォルダーに移動します。   

5. **AdventureWorksLogo.jpg** ファイルを選択し、「**開く**」 をクリックします。

	![画像 11](Linked_image_Files/PowerBI_Lab08A_image13.png)

6. 画像をドラッグして左上隅の位置を変更し、ガイド マーカーをドラッグしてサイズを変更します。

	![画像 12](Linked_image_Files/PowerBI_Lab08A_image14.png)

7. スライサーを追加するには、レポート ページの空の領域をクリックして、最初に画像を選択解除します。

8. 「**フィールド**」 ウィンドウで、「**日付**」 ステップを選択します。**| 年**フィールド (階層の**年**レベルではありません)。  

9. レポート ページに年の値のテーブルが追加されていることに注意してください。

10. ビジュアルをテーブルからスライサーに変換するには、**視覚化**」 ウィンドウで 「**スライサー**」 を選択します。   

	![画像 15](Linked_image_Files/PowerBI_Lab08A_image15.png)

11. スライサーをリストからドロップダウンに変換するには、スライサーの右上にある下矢印をクリックし、「**ドロップダウン**」 を選択します。 

	![画像 18](Linked_image_Files/PowerBI_Lab08A_image16.png)

12. イメージの下に配置されるようにスライサーのサイズを変更し、再配置し、イメージと同じ幅にします。

	![画像 19](Linked_image_Files/PowerBI_Lab08A_image17.png)

13. **年**スライサーで、**FY2020** を選択し、ドロップダウン リストを折りたたみます。

	![画像 20](Linked_image_Files/PowerBI_Lab08A_image18.png)

	*レポート ページは **FY2020*** 年度別にフィルターされています。

14. レポート ページの空の領域をクリックして、スライサーを選択解除します。

15. **地域**に基づいて、2 番目のスライサーを作成する ** | 地域** フィールド (階層の**地域** レベルではありません)。  

16. スライサーをリストのままにして、**年**スライサーでスライサーのサイズを変更し、再配置します。

	![画像 21](Linked_image_Files/PowerBI_Lab08A_image19.png)

17. スライサーを書式設定するには、「**視覚化**」 ウィンドウの下の 「**書式設定**」 ウィンドウを開きます。 

	![画像 22](Linked_image_Files/PowerBI_Lab08A_image20.png)

18. 「**選択コントロール**」 グループを展開します。 

	![画像 23](Linked_image_Files/PowerBI_Lab08A_image21.png)

19. 「**「すべて選択」オプションを表示**」 を 「**オン**」 に設定します。   

	![画像 24](Linked_image_Files/PowerBI_Lab08A_image22.png)

20. 「**地域**」 スライサーで、最初の項目が 「**すべて選択**」 になっていることに注目します。   

	*この項目を選択すると、すべて選択されるか、すべての項目が選択解除されます。レポート ユーザーが適切なフィルターを設定しやすくなります*。

21. レポート ページの空の領域をクリックして、スライサーを選択解除します。

22. ページにグラフを追加するには、「**視覚化**」 ウインドウで、「**折れ線グラフと積み上げ縦棒グラフ**」 視覚化タイプをクリックします。   

	![画像 25](Linked_image_Files/PowerBI_Lab08A_image23.png)

23. ビジュアルのサイズを変更して、ロゴの右側に配置し、レポート ページの幅を調整します。

	![画像 26](Linked_image_Files/PowerBI_Lab08A_image24.png)

24. 次のフィールドをビジュアルにドラッグします。

	* 日付 | 月

	* 売上 | 売上

25. ビジュアル フィールド ウィンドウで (「**フィールド**」 ウィンドウではなく 「ビジュアル フィールド」 ウィンドウは 「**視覚化**」 ウィンドウの下にあります)、フィールドが 「**共有軸**」 および 「**列の値**」 ウェルに割り当てられていることに注目してください。 

	![画像 27](Linked_image_Files/PowerBI_Lab08A_image25.png)

	*ビジュアルをビジュアルにドラッグすると、既定のウェルに追加されます。精度のため、フィールドをウェルに直接ドラッグできます*。

26. 「**フィールド**」 ウィンドウから、「**売上**」 をドラッグする **|** 「**利益幅**」 フィールドを 「**行の値**」 ウェルに入力します。  

	![画像 28](Linked_image_Files/PowerBI_Lab08A_image26.png)

27. ビジュアルには 11 か月のみがあることに注意してください。

	*2020 年 6 月の最後の月は、売り上げがありません (まだ)。デフォルトでは、ビジュアルは BLANK の売上で月を排除しました。次に、すべての月を表示するようにビジュアルを構成します*。

28. ビジュアル フィールド ペインの 「**共有軸**」 ウェルで、「**月**」 フィールドの下向き矢印をクリックし、「**データのないアイテムを表示**」 を選択します。     

	![画像 29](Linked_image_Files/PowerBI_Lab08A_image27.png)

29. **2020 年 6 月**が表示されるようになったことに注意してください。

30. レポート ページの空白領域をクリックして、グラフを選択解除します。

31. ページにグラフを追加するには、「**視覚化**」 ウィンドウで、「**マップ**」 視覚化タイプをクリックします。   

	![画像 32](Linked_image_Files/PowerBI_Lab08A_image28.png)

32. ビジュアルのサイズを変更して再配置し、縦棒グラフ/折れ線グラフの下に配置し、レポート ページの幅の半分を占めるようにします。

	![画像 33](Linked_image_Files/PowerBI_Lab08A_image29.png)

33. ビジュアル ウェルズに次のフィールドを追加します。

	* 場所: **リージョン | 国**

	* 凡例: **製品 | カテゴリ**

	* サイズ: **売上 | 売上**

34. レポート ページの空白領域をクリックして、グラフを選択解除します。

35. ページにグラフを追加するには、「**視覚化**」 ウィンドウで、「**積み上げ横棒グラフ**」 視覚化タイプをクリックします。   

	![画像 34](Linked_image_Files/PowerBI_Lab08A_image30.png)

36. ビジュアルのサイズを変更し、残りのレポート ページ領域を埋めるように再配置します。

	![画像 35](Linked_image_Files/PowerBI_Lab08A_image31.png)

37. ビジュアル ウェルズに次のフィールドを追加します。

	* 軸: **製品 | カテゴリ**

	* 値: **売上 | 数量**

38. ビジュアルを書式設定するには、**書式設定**ウィンドウを開きます。

	![画像 38](Linked_image_Files/PowerBI_Lab08A_image32.png)

39. **「データの色」** グループを展開し、**「既定の色」** プロパティを適切な色に設定します (縦棒グラフとは対照的にします)。

40. **「データ ラベル」** プロパティを**オン**に設定します

	![画像 39](Linked_image_Files/PowerBI_Lab08A_image33.png)

41. Power BI Desktop ファイルを保存します。

	*最初のページのデザインが完了しました*。

  
。 

### タスク 4: デザイン ページ 2

このタスクでは、2 番目のレポート ページを設計します。設計が完了すると、ページは次のようになります。

![画像 41](Linked_image_Files/PowerBI_Lab08A_image34.png)

*ラボで詳細な手順が既に提供されている場合、ラボの手順ではより簡潔な手順が提供されます。詳細な手順が必要な場合は、他のタスクを参照できます*。

1. 新しいページを作成するには、左下のプラス アイコンをクリックします。

	![画像 42](Linked_image_Files/PowerBI_Lab08A_image35.png)

2. ページを**利益**という名前に変更します。

	![画像 43](Linked_image_Files/PowerBI_Lab08A_image36.png)

3. **地域**に基づいてスライサーを追加する ** | 「地域」** フィールド。

4. **書式設定**ウィンドウを使用して、(**「選択コントロール」** グループの) 「すべて選択」 オプションを有効にします。

5. スライサーのサイズを変更して再配置し、レポート ページの左側に配置し、ページの高さの約半分になるようにします。

	![画像 44](Linked_image_Files/PowerBI_Lab08A_image37.png)

6. マトリックス ビジュアルを追加し、サイズを変更して再配置して、レポート ページの残りの領域を埋める

	![画像 45](Linked_image_Files/PowerBI_Lab08A_image38.png)

7. **日付**を追加する ** | ** マトリックス **行**ウェルへの会計階層。

	![画像 46](Linked_image_Files/PowerBI_Lab08A_image39.png)

8. 次の 5 つの **Sales** テーブル フィールドを **「値」** ウェルに追加します。

	* 注文 **(「カウント」** フォルダーから)

	* 売上

	* 原価

	* 利益

	* 利益率

	![画像 3](Linked_image_Files/PowerBI_Lab08A_image40.png)

9. **フィルター** ウィンドウ (**視覚化** ウィンドウの左側) で、**「このページでフィルター」** の詳細を確認します (下にスクロールする必要がある場合があります)。

	![画像 57](Linked_image_Files/PowerBI_Lab08A_image41.png)

10. **フィールド** ウィンドウから、**「製品」** をドラッグする **| 「このページをフィルター」** ウェルに **「カテゴリ」** フィールドを表示します。

11. フィルター カードの中の右上にある矢印をクリックして、カードを折りたたみます。

	![画像 58](Linked_image_Files/PowerBI_Lab08A_image42.png)

	***フィルター** ペインに追加されたフィールドは、スライサーと同じ結果を得ることができます。1 つの違いは、レポート ページのスペースを取らない点です。もう 1 つの違いは、より高度なフィルター要件に合わせて構成できることです*。

12. **「このページのフィルター」** ウェルに、次の各**製品**テーブル フィールドを追加し、それぞれを折りたたみ、**カテゴリ** カードの真下にします。

	* サブカテゴリ

	* 製品

	* 色

	![画像 60](Linked_image_Files/PowerBI_Lab08A_image43.png)

13. **フィルター** ウィンドウを折りたたむには 、ウィンドウの右上にある矢印をクリックします。 

	![画像 68](Linked_image_Files/PowerBI_Lab08A_image44.png)

14. Power BI Desktop ファイルを保存します。

	2 ページ目の設計が完成しました。

### タスク 5: デザイン ページ 3

このタスクでは、3 番目と最後のレポート ページをデザインします。設計が完了すると、ページは次のようになります。  
	![画像 69](Linked_image_Files/PowerBI_Lab08A_image45.png)

1. 新しいページを作成し、その名前を **「マイ パフォーマンス」** に変更します。

	*行レベルのセキュリティは、ユーザーが販売地域とターゲットのデータのみを表示するように構成されていることを思い出してください。このレポートを営業担当者に配布すると、営業実績の結果のみが表示されます*。

2. レポートのデザインとテスト中に行レベルのセキュリティ フィルターをシミュレートするには、**営業担当者 (パフォーマンス)** を追加します ** | Salesperson** フィールドは、「**このページでフィルター**」 ウェル内の 「**フィルター**」 ウィンドウに移動します。    

3. フィルター カードで、営業担当者のリストを下にスクロールし、**Michael Blythe** を確認します。 

	![画像 73](Linked_image_Files/PowerBI_Lab08A_image46.png)

	***Lab 12A*** のアプリでレポートを配布する前に、このフィルターを削除するように指示されます。

4. **日付**に基づいてドロップダウン スライサーを追加する ** | 年** フィールドを使用し、サイズを変更してページの左上隅に配置します。

	![画像 70](Linked_image_Files/PowerBI_Lab08A_image47.png)

5. スライサーで、**FY2019** を選択します。

	![画像 71](Linked_image_Files/PowerBI_Lab08A_image48.png)

6. **複数行カード** ビジュアルを追加し、スライサーの右側に配置され、ページの残りの幅を塗りつぶすサイズと位置を変更します。 

	![画像 72](Linked_image_Files/PowerBI_Lab08A_image49.png)

	![画像 74](Linked_image_Files/PowerBI_Lab08A_image50.png)

7. ビジュアルに次の 4 つのフィールドを追加します。

	* 売上 | 売上

	* ターゲット | ターゲット

	* ターゲット | 差異

	* ターゲット | 差異マージン

8. 次のようにビジュアルの書式を設定します。

	* 「**データ ラベル**」 グループで、「**テキスト サイズ**」 プロパティを **28pt** に増やします。   

	* 「**背景**」 グループで、 明るいグレー色へ**色**を設定します。   

	![画像 79](Linked_image_Files/PowerBI_Lab08A_image51.png)

9. 「**クラスター棒グラフ**」 ビジュアルを追加し、サイズを変更し、再配置して、複数行カードビジュアルの下に位置し、ページの残りの高さと、複数行カードビジュアルの幅の半分を埋めます。 

	![画像 77](Linked_image_Files/PowerBI_Lab08A_image52.png)

	![画像 78](Linked_image_Files/PowerBI_Lab08A_image53.png)

10. ビジュアル ウェルズに次のフィールドを追加します。

	* 軸: **日付 | 月**

	* 値: **売上 | 販売**と**ターゲット | ターゲット**

	![画像 80](Linked_image_Files/PowerBI_Lab08A_image54.png)

11. ビジュアルのコピーを作成するには、**「Ctrl + C」** キーを押し、**「Ctrl + V」** キーを押します。

12. コピーしたビジュアルを元のビジュアルの右側に配置します。

	![画像 82](Linked_image_Files/PowerBI_Lab08A_image55.png)

13. 視覚化の種類を変更するには、**「視覚化」** ウィンドウで、**「クラスター化された縦棒グラフ」** を選択します。

	![画像 81](Linked_image_Files/PowerBI_Lab08A_image56.png)

	*2 つの異なる視覚化タイプで表現された同じデータを表示できるようになりました。これはページ レイアウトの良い使用ではありませんが、 ビジュアルを重ね合わせることによって、**ラボ 09A** で改善されます。ページにボタンを追加すると、レポート ユーザーは 2 つのビジュアルのうちどちらが表示されているかを判断できるようになります*。

	*3 ページ目と最終ページのデザインが完成しました。*

### タスク 6: レポートの公開

このタスクでは レポートを発行します。

1. 「**概要**」 ページを選択します。 

2. Power BI Desktop ファイルを保存します。

3. **「ホーム」** リボン タブの **「共有」** グループ内で、**「発行」** をクリックします。

	![画像 64](Linked_image_Files/PowerBI_Lab08A_image57.png)

4. レポートを **「販売分析」** ワークスペースに公開します。

5. Power BI Desktop を開いたままにしておきます。

	*次の演習では、Power BI サービスでレポートを調べます*。

# 演習 2: レポートを見る

この演習では、Power BI サービスの**販売レポート**を確認します。

### タスク 1: レポートの調査

このタスクでは、Power BI サービスの**売上レポート**を調べます。

1. エッジの Power BI サービスの **「ナビゲーション」** ウィンドウで、**「営業分析」** ワークスペースの内容を確認し、**「売上レポート」** をクリックします。

	![画像 83](Linked_image_Files/PowerBI_Lab08A_image58.png)

	*レポートのパブリケーションによって、ワークスペースにレポートが追加されました。表示されない場合は、**「F5」** キーを押してブラウザーをリロードし、ワークスペースを再度展開します*。

2. **リージョン** スライサーで、**「Ctrl」** キーを押しながら複数のリージョンを選択します。

3. 縦棒グラフで、ページをクロス フィルター処理する月の列を選択します。

4. **「Ctrl」** キーを押しながら、追加の月を選択します。

	*既定では、クロス フィルター処理によってページ上の他のビジュアルがフィルター処理されます*。

5. 棒グラフは、フィルター処理された月を表す棒の太字部分であり、フィルター処理され、強調表示されていることに注意してください。

6. ビジュアルの上にカーソルを置き、右上のフィルター アイコンをクリックします。

	![画像 88](Linked_image_Files/PowerBI_Lab08A_image59.png)

	*フィルター アイコンを使用すると、他の ビジュアル のスライサーやクロス フィルターなど、ビジュアルに適用されるすべてのフィルターを把握できます*。

7. バーの上にカーソルを置き、ヒント情報を確認します。

8. クロス フィルターを元に戻すには、縦棒グラフまたは折れ線グラフで、ビジュアルの空の領域をクリックします。

9. マップ ビジュアルの上にカーソルを移動し、右上の **「フォーカス」** アイコンをクリックします。

	![画像 85](Linked_image_Files/PowerBI_Lab08A_image60.png)

	*フォーカス モードでは、ビジュアルがページ全体のサイズにズームします*。

10. 円グラフの別のセグメントにカーソルを合わせると、ヒントが表示されます。

11. レポート ページに戻るには、左上の **「レポートに戻る」** をクリックします。

	![画像 86](Linked_image_Files/PowerBI_Lab08A_image61.png)

12. もう一度マップ ビジュアルの上にカーソルを移動し、省略記号 (..) をクリックして、メニュー オプションに注目します。

	![画像 87](Linked_image_Files/PowerBI_Lab08A_image62.png)

13. 各オプションを試してみてください。

14. 左側の **「ページ」** ウィンドウで、**「利益」** ページを選択します。

	![画像 84](Linked_image_Files/PowerBI_Lab08A_image63.png)

15. **「領域」** スライサーは、「概要」 ページの **「リージョン」** スライサーとは異なる選択を行うことに注目してください。  
	*スライサーは同期されません。次の演習では、レポート デザインを変更して、ページ間で同期するようにします*。

16. 右側にある **「フィルター」** ウィンドウで、フィルター カードを展開し、いくつかのフィルターを適用します。      
***「フィルター」** ペインでは、ページ上でスライサーとして収まる可能性がある以上のフィルターを定義できます*。

17. マトリックス ビジュアルで、プラス (+) ボタンを使用して、**会計**階層に展開します。

18. **「マイ パフォーマンス」** ページを選択します。  
	![画像 89](Linked_image_Files/PowerBI_Lab08A_image64.png)

19. メニュー バーの右上にある 「表示」 をクリックし、「全画面表示」 を選択します。  
	![画像 90](Linked_image_Files/PowerBI_Lab08A_image65.png)

20. スライサーを変更し、ページをクロス フィルタリングしてページを操作します。

21. 左下で、ページを変更するコマンド、ページ間を前後に移動するコマンド、または全画面表示モードを終了するコマンドに注目してください。

22. 全画面表示モードを終了します。  
	![画像 91](Linked_image_Files/PowerBI_Lab08A_image66.png)

23. ワークスペースに戻るには、階層リンクの軌跡でワークスペース名をクリックします。  
	![画像 92](Linked_image_Files/PowerBI_Lab08A_image67.png)

24. 「エッジ」 のブラウザー画面は開いたままにします。  
	* **Lab 09A*** の高度な機能を備えたレポート設計を強化します。
