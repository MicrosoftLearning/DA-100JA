

### ラボ 09A

Power BI Desktop でレポートをデザインする (パート 2)

# 概要

**ラボを完了するための所要時間は 45 分です**

このラボでは、 詳細なデザイン機能を使用して、**売上レポート**を拡張します。

このラボでは、次の方法を学習します。

* スライサーの同期

* ドリルスルー ページの作成

* 条件付き書式の適用

* ブックマークの作成と使用

# 演習 1: 同期スライサーを構成する

この演習では、レポート ページ スライサーを同期します。

### タスク 1: スライサーの同期

このタスクでは、 **年**と**地域**スライサーを同期します。   

***Lab 08A*** で設計を開始したレポートの開発を継続します。

1. Power BI Desktop の **Sales Report**ファイルの 「**概要**」 ページで、「**Year**」 スライサーを 「**FY2018**」 に設定します。

2. 「**マイパフォーマンス**」 ページに移動し、「**Year**」 スライサーの値が異なっていることを確認します。

	*スライサーが同期されていない場合、データの不正確性やレポート ユーザーの不満につながる可能性があります。レポート スライサーを同期します*。

3. 「**概要**」 ページに移動し、「**Year**」 スライサーを選択します。

4. 「**表示**」 リボン タブの 「**ペインの表示**」 グループ内で、「**スライサーの同期**」 をクリックします。

	![画像 1](Linked_image_Files/PowerBI_Lab09A_image1.png)

5. 「**視覚化**」 ウィンドウの左側にある 「**スライサーの同期**」 ウィンドウで、2 番目の列 (同期を表す) で、「**概要**」 ページと 「**マイパフォーマンス**」 ページのチェック ボックスをオンにします。

	![画像 93](Linked_image_Files/PowerBI_Lab09A_image2.png)

6. 「**概要**」 ページで、「**Region**」 スライサーを選択します。   

7. 「**概要**」 ページと 「**利益**」 ページをスライサーと同期します。   

	![画像 94](Linked_image_Files/PowerBI_Lab09A_image3.png)

8. 異なるフィルター オプションを選択し、同期されたスライサーが同じオプションでフィルターすることを確認して、同期スライサーをテストします。

9. 「**スライサーの同期**」 ページを閉じるには、ウィンドウの右上にある 「**X**」 をクリックします。

	![画像 98](Linked_image_Files/PowerBI_Lab09A_image4.png)

# 演習 2: ドリル スルーの構成

この演習では、新しいページを作成し、ドリル スルー ページとして構成します。設計が完了すると、ページは次のようになります。  

![画像 69](Linked_image_Files/PowerBI_Lab09A_image5.png)

### タスク 1: ドリル スルー ページを作成する

このタスクでは、新しいページを作成し、ドリル スルー ページとして構成します。

1. 「**製品の詳細**」 という名前の新しいレポート ページを追加します。

	![画像 95](Linked_image_Files/PowerBI_Lab09A_image6.png)

2. 「**製品の詳細**」 ページ タブを右クリックし、「**ページの非表示**」 を選択します。

	![画像 97](Linked_image_Files/PowerBI_Lab09A_image7.png)

	*レポート ユーザーは、ドリル スルー ページに直接移動できません。他のページのビジュアルからアクセスする必要があります。このラボの最後の演習で、ページをドリル スルーする方法を学習します*。

3. 「**視覚化**」 ウィンドウの下の 「**ドリル スルー**」 セクションで、「**ドリル スルー フィールドの追加**」 ボックスに「**Product | Category**」 フィールドを追加します。

	![画像 96](Linked_image_Files/PowerBI_Lab09A_image8.png)

4. ドリル スルー ページをテストするには、ドリル スルー フィルター カードで 「**Bikes**」 を選択します。 

	![画像 99](Linked_image_Files/PowerBI_Lab09A_image9.png)

5. レポート ページの左上にある矢印ボタンに注目してください。

	![画像 100](Linked_image_Files/PowerBI_Lab09A_image10.png)

	*ボタンが自動的に追加されました。これにより、レポート ユーザーは、ドリル スルーしたあと、ページに戻ることができます*。

6. ページに **カード** ビジュアルを追加し、サイズを変更して、ボタンの右側に配置し、ページの残りの幅を埋めるようにします。 

	![画像 102](Linked_image_Files/PowerBI_Lab09A_image11.png)

	![画像 101](Linked_image_Files/PowerBI_Lab09A_image12.png)

7. 「**Product | Category**」 をカード ビジュアルにドラッグします。

8. ビジュアルの書式オプションを構成し、「**カテゴリ ラベル**」 プロパティを 「**オフ**」 にします。

	![画像 103](Linked_image_Files/PowerBI_Lab09A_image13.png)

9. 「**背景色**」 プロパティを薄いグレーに設定します。

10. ページに **テーブル** ビジュアルを追加し、サイズを変更して、カード ビジュアルの下に配置し、ページ上の残りの領域を埋めます。

	![画像 104](Linked_image_Files/PowerBI_Lab09A_image14.png)

	![画像 105](Linked_image_Files/PowerBI_Lab09A_image15.png)

11. ビジュアルに次のフィールドを追加します。

	* Product | Subcategory

	* Product | Color

	* Sales | Quantity

	* Sales | Sales

	* Sales | Profit Margin

12. ビジュアルの書式オプションを構成し、「**グリッド**」 セクションで、「**テキスト サイズ**」 プロパティを **20pt** に設定します。

	*ドリル スルー ページの設計はほぼ完了です。次の演習では、条件付き書式を定義します*。

# 演習 3: 条件付き書式の追加

この演習では、条件付き書式を使用してドリル スルー ページを拡張します。設計が完了すると、ページは次のようになります。  

![画像 106](Linked_image_Files/PowerBI_Lab09A_image16.png)

### タスク 1: 条件付き書式を追加する

このタスクでは、条件付き書式を使用してドリル スルー ページを拡張します。

1. テーブル ビジュアルを選択します。

2. 「ビジュアル フィールド」 ウィンドウの 「**Profit Margin**」 フィールドで、下向き矢印をクリックし、「**条件付き書式**」 を選択します。 | 「**アイコン**」 を選択します。

	![画像 107](Linked_image_Files/PowerBI_Lab09A_image17.png)

3. 「**アイコン - Profit Margin**」 ウィンドウの 「**アイコン レイアウト**」 ドロップダウン リストで、「**データの右側**」 を選択します。

	![画像 108](Linked_image_Files/PowerBI_Lab09A_image18.png)

4. 中央のルールを削除するには、黄色い三角形の左側にある 「**X**」 をクリックします。 

	![画像 109](Linked_image_Files/PowerBI_Lab09A_image19.png)

5. 最初のルール (赤いひし形) を次のように設定します。

	* 2 番目のコントロールで、値を削除します

	* 3 番目のコントロールで、「**数値**」 を選択します

	* 5 番目のコントロールに **0** と入力します 

	* 6 番目のコントロールで、「**数値**」 を選択します

6. 2 番目のルール (緑の円) を次のように構成します。

	* 2 番目のコントロールに **0** と入力します

	* 3 番目のコントロールで、「**数値**」 を選択します

	* 5 番目のコントロールで、値を削除します

	* 6 番目のコントロールで、「**数値**」 を選択します

	![画像 110](Linked_image_Files/PowerBI_Lab09A_image20.png)

	*ルールは次のとおりです: 利益幅の値が 0 未満の場合は赤いひし形を表示します。もしくは、値が 0 より大きいか、等しい場合は、緑の円を表示します*。

7. 「**OK**」 をクリックします。

	![画像 111](Linked_image_Files/PowerBI_Lab09A_image21.png)

8. テーブル ビジュアルで、正しいアイコンが表示されていることを確認します。

	![画像 112](Linked_image_Files/PowerBI_Lab09A_image22.png)

9. 「**Color**」 フィールドの背景色の条件付き書式を構成します。 

10. 「**背景色 - Color**」 ウィンドウの 「**書式設定基準**」 ドロップダウン リストで、「**フィールド値**」 を選択します。

	![画像 113](Linked_image_Files/PowerBI_Lab09A_image23.png)

11. 「**フィールドに基づく**」 ドロップダウン リストで、「**Product | Formatting | Background Color Format**」 を選択します。

	![画像 114](Linked_image_Files/PowerBI_Lab09A_image24.png)

12. 「**OK**」 をクリックします。

	![画像 115](Linked_image_Files/PowerBI_Lab09A_image25.png)

13. 上記の手順を繰り返して、 次を使用して 「**色**」 フィールドのフォント色の条件付き書式を設定します。「**Product | Formatting |Font Color Format** フィールド

	*背景色とフォント色は、**Lab 02A** の **ColorFormats.csv** ファイルがソースであり、**Lab 03A** の**製品** クエリと統合されました*。

# 演習 4: ブックマークとボタンを追加する

この演習では、「**パフォーマンス**」 ページをボタンで拡張し、レポート ユーザーが表示する視覚化タイプを選択できるようにします。設計が完了すると、ページは次のようになります。  

![画像 116](Linked_image_Files/PowerBI_Lab09A_image26.png)

### タスク 1: ブックマークを追加する

このタスクでは、月ごとの販売/目標ビジュアルを表示する 2 つのブックマークを追加します。

1. 「**パフォーマンス**」 ページに移動します。

2. 「**表示**」 リボン タブの 「**ペインの表示**」 グループ内で、「**ブックマーク**」 をクリックします。

	![画像 118](Linked_image_Files/PowerBI_Lab09A_image27.png)

3. 「**表示**」 リボン タブの 「**ペインの表示**」 グループ内で、「**選択項目**」 をクリックします。

	![画像 119](Linked_image_Files/PowerBI_Lab09A_image28.png)

4. 「**選択項目**」 ウィンドウの 「**MonthによるSalesおよびTarget**」 項目の横にあるビジュアルを非表示にするには、目のアイコンをクリックします。

	![画像 120](Linked_image_Files/PowerBI_Lab09A_image29.png)

5. 「**ブックマーク**」 ウィンドウで、「**追加**」 をクリックします。

	![画像 121](Linked_image_Files/PowerBI_Lab09A_image30.png)

6. ブックマークの名前を変更するには、ブックマークをダブルクリックします。

7. 表示されているグラフが横棒グラフの場合は、ブックマークの名前を**横棒グラフ ON** に、それ以外はブックマークの名前を**縦棒グラフ ON** に変更します。

8. 「**選択項目**」 ウィンドウで、2 つの「**月別売上と目標**」 アイテムの表示を切り替えます。

	*つまり、表示されているビジュアルを非表示にして、非表示のビジュアルを表示させます*。

	![画像 122](Linked_image_Files/PowerBI_Lab09A_image31.png)

9. 2 番目のブックマークを作成し、適切な名前を付けます (**縦棒グラフ ON** または **横棒グラフ ON)。**

	![画像 123](Linked_image_Files/PowerBI_Lab09A_image32.png)

10. 「**選択項目**」 ウィンドウで、両方のビジュアルを表示するには、非表示のビジュアルをシンプルに表示します。 

11. 両方のビジュアルのサイズを変更して再配置し、マルチカード ビジュアルの下のページ全体に表示され、互いに完全に重なるようにします。

	*ヒント: 隠れたビジュアルを選択するには、「**選択項目**」 ウィンドウで選択します*。

	![画像 124](Linked_image_Files/PowerBI_Lab09A_image33.png)

12. **ブックマーク** ウィンドウで、各ブックマークを選択し、ビジュアルの 1 つだけが表示されていることを確認します。

	*設計の次の段階では、ページに 2 つのボタンを追加して、レポート ユーザーがブックマークを選択できるようにします*。

### タスク 2: ボタンの追加

このタスクでは、2 つのボタンを追加し、それぞれにブックマーク アクションを割り当てます。

1. 「**挿入**」 リボンの 「**要素**」 グループから、「**ボタン**」 をクリックしてから、「**空白**」 を選択します。

	![画像 125](Linked_image_Files/PowerBI_Lab09A_image34.png)

2. 「**Year**」 スライサーの真下にボタンを再配置します。

3. ボタンを選択し、「**視覚化**」 ウィンドウで「**ボタン テキスト**」 プロパティを 「**オン**」 にします。

	![画像 126](Linked_image_Files/PowerBI_Lab09A_image35.png)

4. 「**ボタン テキスト**」 セクションを展開し、「**ボタン テキスト**」 ボックスに「**横棒グラフ**」と入力します。

5. 適切な色を使用して背景色を書式設定します。

6. 「**アクション**」 プロパティを 「**オン**」 にします (リストの下部近くにあります)。

	![画像 127](Linked_image_Files/PowerBI_Lab09A_image36.png)

7. 「**アクション**」 セクションを展開し、「**種類**」 ドロップダウンリストを 「**ブックマーク**」 に設定します。

8. 「**ブックマーク**」 ドロップダウン リストで、「**横棒グラフ ON**」 を選択します。

	![画像 128](Linked_image_Files/PowerBI_Lab09A_image37.png)

9. コピーと貼り付けを使用してボタンのコピーを作成し、次のように新しいボタンを構成します。

	* 「**ボタン テキスト**」 プロパティを 「**縦棒グラフ**」 に設定する

	* 「**アクション**」 セクションで、「**ブックマーク**」 ドロップダウン リストを 「**縦棒グラフ ON**」 に設定します

### タスク 3: レポートの公開

このタスクではレポートを発行します。

1. 「**概要**」 ページを選択します。

2. 「**Year**」 スライサーで、「**FY2020**」 を選択します。

3. 「**Region**」 スライサーで、「**すべて選択**」 を選択します。

4. Power BI Desktop ファイルを保存します。

5. レポートを **「Sales Analysis」** ワークスペースに公開します。

6. レポートを置き換えるメッセージが表示されたら、「**置換**」 をクリックします。 

	![画像 129](Linked_image_Files/PowerBI_Lab09A_image38.png)

7. Power BI Desktop を開いたままにしておきます。

	*次の演習では、Power BI サービスでレポートを調べます*。

# 演習 5: レポートを見る

この演習では、Power BI サービスの**Sales Report**を確認します。

### タスク 1: レポートの調査

このタスクでは、Power BI サービスの**Sales Report**を調べます。

1. Microsoft Edge の Power BI サービスで、「**Sales Report**」 レポートを開きます。

2. ドリル スルー レポートをテストするには、「**CategoryによるQuantity**」 ビジュアルで 「**Clothing**」 バーを右クリックし、「**ドリルスルー | 製品の詳細**」 を選択します。 。

	![画像 130](Linked_image_Files/PowerBI_Lab09A_image39.png)

3. 「**製品の詳細**」 ページは **服飾用** であることを確認します。

4. ソース ページに戻るには、左上隅の矢印ボタンをクリックします。

5. **「マイ パフォーマンス」** ページを選択します。

6. 各ボタンをクリックすると、別のビジュアルが表示されます。

### 仕上げ

このタスクでは、ラボを完了します。

1. ワークスペースに戻るには、階層リンクの軌跡でワークスペース名をクリックします。

	![画像 92](Linked_image_Files/PowerBI_Lab09A_image40.png)

2. 「エッジ」 のブラウザー画面は開いたままにします。

3. Power BI Desktop で、「**自分の実績**」 ページに移動し、「**フィールド**」 ウィンドウで「**営業担当**」 フィルター カードを削除します。

	![画像 132](Linked_image_Files/PowerBI_Lab09A_image41.png)

4. 「**概要**」 ページを選択します。

5. Power BI Desktop ファイルを保存し、**売上分析**ワークスペースに再発行します。

6. Power BI Desktop を閉じます。

	***ラボ 12A** でレポートを共有すると、レポートは行レベルのセキュリティを施行します*。
