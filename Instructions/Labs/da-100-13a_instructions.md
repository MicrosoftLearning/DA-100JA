

### ラボ 13A

ページ分割されたレポートの作成

# 概要

**ラボを完了するための所要時間は 45 分です**

このラボでは、Power BI レポート ビルダーを使用して、**AdventureWorksDW2020** SQL サーバー データベースからデータをソースするピクセルに最適な改ページ調整されたレポート レイアウトを開発します。データ ソースとデータセットを作成し、レポート パラメーターも構成します。レポート レイアウトでは、データを複数のページにレンダリングし、PDF やその他の形式でエクスポートできます。

最終的なレポートは、以下のようなものになります。  

![画像 10](Linked_image_Files/PowerBI_Lab13A_image1.png)

このラボでは、次の方法を学習します。

* Power BI レポート ビルダーの使用

* 複数ページのレポート レイアウトをデザインする

* データ ソースの定義

* データセットの定義

* レポート パラメーターの作成

* レポートを PDF にエクスポートする

# 演習 1: はじめに

この演習では、Power BI レポート ビルダーを開いてレポートを作成し、保存します。

### タスク 1: レポートの作成

このタスクでは、Power BI レポート ビルダーを開いてレポートを作成し、保存します。

1. Power BI レポート ビルダーを開くには、タスク バーで **Power BI レポート ビルダー**のショートカットをクリックします。

	![画像 32](Linked_image_Files/PowerBI_Lab13A_image2.png)

2. 「Power BI レポート ビルダー」 ウィンドウで新しいレポートを作成するには、「**作業の開始**」 ウィンドウで 「**空白のレポート**」 をクリックします。

	![画像 5](Linked_image_Files/PowerBI_Lab13A_image3.png)

3. レポートを保存するには、左上にある 「**ファイル**」 タブをクリックし、「**保存**」 を選択します。

	![C:\Users\PETERM~1\AppData\Local\Temp\SNAGHTML32fddfaf.PNG](Linked_image_Files/PowerBI_Lab13A_image4.png)

4. 「**レポートとして保存」**」 ウィンドウで、**D:\DA100\MySolution** フォルダーに移動します。

5. 「**名前**」 ボックスに「**販売注文レポート**」と入力します。

6. 「**保存**」 をクリックします。

# 演習 2: レポート レイアウトの開発

この演習では、レポートのレイアウトを開発し、最終的なレポートのデザインを検討します。

### タスク 1: レポート ヘッダーの構成

このタスクでは、レポート ヘッダーを構成します。

1. レポート デザイナーで、本文領域とレポート フッター領域で構成される既定のレポート レイアウトに注目してください。

	![C:\Users\PETERM~1\AppData\Local\Temp\SNAGHTML330700e8.PNG](Linked_image_Files/PowerBI_Lab13A_image5.png)

	*本文には、レポート タイトルの準備ができた単一のテキスト ボックスが含まれ、レポート フッターにはレポートの実行時間を説明する単一のテキスト ボックスが含まれています*。

	*既定のデザインでは、最初にレンダリングされたページにレポート タイトルが本文に 1 回表示されます。レポート ヘッダー領域を追加し、レポート タイトルのテキスト ボックスをこの領域に移動して、レポート デザインを変更します。この方法では、レポートのタイトルがすべてのページで繰り返されます。また、会社のロゴの画像を追加します*。

2. レポート ヘッダー領域を追加するには、「**挿入**」 リボン タブの 「**ヘッダーとフッター**」 グループ内の 「**ヘッダー**」 をクリックし、「**ヘッダーの追加**」 をクリックします。

	![C:\Users\PETERM~1\AppData\Local\Temp\SNAGHTML33038ea4.PNG](Linked_image_Files/PowerBI_Lab13A_image6.png)

3. レポート デザイナーで、レポート ヘッダー領域がレポート レイアウトに追加されていることに注目してください。

4. 本文のテキスト ボックスを選択するには、「クリックしてタイトルを追加」テキスト ボックスをクリックします。

5. テキスト ボックスを移動するには、四方向の矢印アイコンをクリックし、ヘッダー領域にドラッグして、レポート ヘッダー領域の一番左にドロップします。

	![C:\Users\PETERM~1\AppData\Local\Temp\SNAGHTML330925bc.PNG](Linked_image_Files/PowerBI_Lab13A_image7.png)

6. レポート タイトルのテキスト ボックス テキストを変更するには、テキスト ボックス内をクリックし、次のように入力します。**販売注文レポート**

	*テキスト ボックスのサイズを変更するには、まず 「**プロパティ**」 ウィンドウを開きます。位置とサイズのプロパティを詳細に制御するには、「**プロパティ**」 ペイン を使用する必要があります*。

7. 「**表示**」 リボン タブの 「**表示/非表示**」 グループ内で、「**プロパティ**」 をオンにします。

	![画像 27](Linked_image_Files/PowerBI_Lab13A_image8.png)

8. レポート タイトルのテキスト ボックスを選択するには、まずテキスト ボックスの外側の領域をクリックし、テキスト ボックスをもう一度クリックします。

	*テキスト ボックスの枠線が強調表示され、サイズ変更ハンドル (小さな円) が境界線に表示されると、テキスト ボックスが選択されます*。

9. 右側の 「**プロパティ**」 ペインで、リストを下にスクロールして 「**位置**」 グループを見つけます。

	![画像 28](Linked_image_Files/PowerBI_Lab13A_image9.png)

	*「**位置**」 グループでは、レポート アイテムの場所とサイズの正確な値を設定できます*。

	*このラボで説明したとおりに値を入力することが重要です。ラボの最後でページ レンダリングを実現するには、ピクセルパーフェクトなレイアウトが必要です*。

10. 「**位置」**」 グループで、「**場所**」 グループを展開し、「**Left**」 プロパティと 「**Top**」 プロパティがそれぞれ 「**0in**」 に設定されていることを確認します。

	*場所とサイズの単位はインチ単位で、ラボ仮想マシンの地域設定は米国に設定されています。地域でメートル法の測定値を使用する場合、センチメートルが既定の単位になります*。

11. 「**位置**」 グループ内で、「**サイズ**」 グループを展開し、「**幅**」 プロパティを **4** に設定します。

	![画像 35](Linked_image_Files/PowerBI_Lab13A_image10.png)

12. イメージを挿入するには、「**挿入**」 リボン タブの 「**レポート アイテム**」 グループ内で、「**イメージ**」 をクリックします。

	![画像 31](Linked_image_Files/PowerBI_Lab13A_image11.png)

13. レポート デザインにイメージを追加するには、レポート ヘッダー領域内のレポート タイトル テキスト ボックスの右側をクリックします。

14. 「**イメージのプロパティ」**」 ウィンドウで、イメージ ファイルからインポートする場合は、「**インポート**」 をクリックします。

	![画像 33](Linked_image_Files/PowerBI_Lab13A_image12.png)

15. 「**開く**」 ウィンドウで、**D:\DA100\Data** フォルダーに移動し、**AdventureWorksLogo.jpg** ファイルを選択します。

16. 「**開く**」 をクリックします。

17. 「**イメージのプロパティ**」 ウィンドウで、「**OK**」 をクリックします。

18. レポート デザイナーで、イメージが追加され、選択されていることに注目してください。

19. イメージの位置とサイズを変更するには、「**プロパティ**」 ウィンドウで次のプロパティを構成します。

	|  プロパティ | 値 |   |   |
	|  ------  |  ---- | ---- | ---- |
	|  位置 | 場所 | 左 | 5 |
	|  位置 | 場所 | トップ | 0 |
	|  位置 | サイズ | 幅 | 1  |
	|  位置 | サイズ | 高さ | 1 |


20. レポート ヘッダー領域のサイズを変更するには、領域の空白領域をクリックして、領域を選択します。

21. 「**プロパティ**」 ペインで、「**全般**」 を設定します。**|** 「**高さ**」 プロパティを **1** にします。

22. レポート ヘッダー領域に 1 つのテキスト ボックスとイメージが含まれていることを確認します。次のようになります。

	![画像 34](Linked_image_Files/PowerBI_Lab13A_image13.png)

23. レポートを保存するには、「**ファイル**」 タブで 「**保存**」 をクリックします。

	*ヒント: 左上にあるディスク アイコンをクリックすることもできます*。

	![画像 106](Linked_image_Files/PowerBI_Lab13A_image14.png)

	*これで、データベース クエリの結果を取得するようにレポートを構成する準備ができました*。

### タスク 2: データを取得する

このタスクでは、データ ソースとデータセットを作成して、**AdventureWorksDW2020** SQL サーバー データベースからクエリ結果を取得します。

1. 「**レポート データ**」 ペイン (左側) で、「**データ ソース**」 フォルダーを右クリック し、「**データ ソースの追加**」 を選択します。

	![C:\Users\PETERM~1\AppData\Local\Temp\SNAGHTML3367f3d0.PNG](Linked_image_Files/PowerBI_Lab13A_image15.png)

	*クラウド データベース、オンプレミス データベース、または Power BI データセットからデータを取得できます*。

2. 「**データ ソースのプロパティ**」 ウィンドウの 「**名前**」 ボックスで、テキストを **AdventureWorksDW2020** に置き換えます。

3. 「**接続の種類の選択**」 ドロップダウン リストで、「**Microsoft SQL Server**」 が選択されていることを確認します。

4. 接続文字列を作成するには、「**ビルド**」 をクリックします。

	![画像 1](Linked_image_Files/PowerBI_Lab13A_image16.png)

5. 「**接続のプロパティ**」 ウィンドウの 「**サーバー名**」 ボックスに、「**localhost**」と入力します。

	*ラボでは、**localhost** を使用して SQL サーバー データベースに接続します。ただし、独自のソリューションを作成する場合は、この方法はお勧めしません。これは、ゲートウェイ データソースが **localhost*** を解決できないためです。

6. 「**データベース名の選択または入力**」 ドロップダウン リストで、**AdventureWorksDW2020** を選択します。

7. 「**OK**」 をクリックします。

8. 「**データ ソースのプロパティ**」 ウィンドウで 「**OK**」 をクリックします。

9. 「**レポート データ**」 ペインで、**AdventureWorksDW2020** データ ソースが追加されていることに注目してください。

	![画像 2](Linked_image_Files/PowerBI_Lab13A_image17.png)

10. データセットを作成するには、「**レポート データ**」 ペインで **AdventureWorksDW2020** データ ソースを右クリックし、「**データセットの追加**」 を選択します。

	![C:\Users\PETERM~1\AppData\Local\Temp\SNAGHTML336e389c.PNG](Linked_image_Files/PowerBI_Lab13A_image18.png)

	*レポート データセットは、Power BI データセット とは異なる目的と構造があります*。

11. 「**データセットのプロパティ**」 ウィンドウの 「**名前**」 ボックスで、テキストを **SalesOrder** に置き換えます。

12. 定義済みのクエリをインポートするには、「**インポート**」 をクリックします。

	![画像 40](Linked_image_Files/PowerBI_Lab13A_image19.png)

13. **クエリのインポート** ウィンドウで、**D:\DA100\Lab13A\Assets** フォルダーに移動し、**SalesOrder.sql** ファイルを選択します。

14. 「**開く**」 をクリックします。

15. 「**クエリ**」 ボックスでクエリを確認し、クエリ テキストの一番下までスクロールします。

	*クエリ ステートメントの詳細を理解することは重要ではありません。販売注文明細行の詳細を取得するように設計されています。WHERE 句には、クエリ結果を単一の販売注文に制限する述語が含まれています。ORDER BY 句は、行番号順で行が返されるようにします*。

16. クエリ パラメーターを表す WHERE 句で **@SalesOrderNumber** が使用されていることに注意してください。

	![画像 3](Linked_image_Files/PowerBI_Lab13A_image20.png)

	*クエリ パラメーターは、クエリの実行時に渡される値のプレースホルダーです。レポート ユーザーに対して、クエリ パラメーター に渡される 1 つの販売注文番号の入力を求めるレポート パラメーターを構成します*。

16. 「**OK**」 をクリックします。

17. 「**レポート データ**」 ペインで、**SalesOrder** データセットとそのフィールドが追加されていることに注目してください。 

	![画像 44](Linked_image_Files/PowerBI_Lab13A_image21.png)

	*フィールドは、レポート レイアウトのデータ領域を構成するために使用されます。これらは、データセット クエリ列から派生したものです*。

18. レポートを保存します。

### タスク 3: レポート パラメーターの構成

このタスクでは、既定値を使用してレポート パラメーターを構成します。

1. 「**レポート データ**」 ペインで、「**パラメーター**」 フォルダーを展開して、**SalesOrderNumber** レポート パラメーターを表示します。     

	![画像 107](Linked_image_Files/PowerBI_Lab13A_image22.png)

	*データセットの作成時に、**SalesOrderNumber** レポート パラメーターが自動的に追加されました。  これは、データセット クエリに **@SalesOrderNumber** クエリ パラメーターが含まれているためです*。  

2. レポート パラメーターを編集するには、**SalesOrderNumber** レポート パラメーターを右クリックし、「**パラメーターのプロパティ**」 を選択します。   

	![画像 46](Linked_image_Files/PowerBI_Lab13A_image23.png)

3. 「**レポート パラメーターのプロパティ**」 ウィンドウの左側で、「**既定値**」 ページを選択します。   

	![画像 48](Linked_image_Files/PowerBI_Lab13A_image24.png)

4. 「**値を指定**」 オプションを選択します。 

	![画像 49](Linked_image_Files/PowerBI_Lab13A_image25.png)

5. 既定値を追加するには、「**追加**」 をクリックします。

6. 「**値**」 ドロップダウン リストで、テキストを **43659** に置き換えます。

	![画像 50](Linked_image_Files/PowerBI_Lab13A_image26.png)

	*受注 43659 は、最初にレポートのデザインのテストに使用する値です*。

7. 「**OK**」 をクリックします。

8. レポートを保存します。

	*次に、販売注文を説明するテキスト ボックスを追加して、レポート ヘッダー領域のデザインを完了します*。

### タスク 4: レポート ヘッダー レイアウトの確定

このタスクでは、テキスト ボックスを追加してレポート ヘッダー領域のデザインを完成させます。

1. レポート ヘッダー領域にテキスト ボックスを追加するには、「**挿入**」 リボン タブの 「**レポート アイテム**」 グループ内で、「**テキスト ボックス**」 をクリックします。

	![画像 51](Linked_image_Files/PowerBI_Lab13A_image27.png)

2. レポート ヘッダー領域内をクリックし、レポート タイトルのテキスト ボックスのすぐ下をクリックします。

3. テキストボックス内に「**販売注文:** 」と入力し、続けてスペースを入力します。

4. プレースホルダーを挿入するには、入力したスペースの直後に右クリックし、「**プレースホルダーの作成**」 を選択します。

	![画像 109](Linked_image_Files/PowerBI_Lab13A_image28.png)

5. 「**プレースホルダーのプロパティ**」 ウィンドウの 「**値**」 ドロップダウン リストの右側にある 「**fx**」 ボタンをクリックします。

	![画像 53](Linked_image_Files/PowerBI_Lab13A_image29.png)

	*「**fx**」 ボタンを使用すると、カスタム式を入力できます。この式は、受注番号を返すために使用されます*。

6. **式**ウィンドウの 「**カテゴリ**」 の一覧で、「**パラメーター**」 を選択します。

	![画像 54](Linked_image_Files/PowerBI_Lab13A_image30.png)

7. 「**値**」 の一覧で、「**SalesOrderNumber**」 パラメーターをダブルクリックします。

8. 式ボックスに、プログラムによる **SalesOrderNumber** レポート パラメーターへの参照が追加されたことを確認します。

	![画像 55](Linked_image_Files/PowerBI_Lab13A_image31.png)

9. 「**OK**」 をクリックします。

10. 「**プレースホルダー プロパティ**」 ウィンドウで、「**OK**」 をクリックします。

11. レポート ヘッダー領域の空白領域をクリックし、新しいテキスト ボックスを選択します。

12. 「**プロパティ」** ウィンドウで、次の位置プロパティを構成します。

	|  プロパティ                    |  値|
	|  :---                        |  :--- |
	|  位置 \| 場所 \| 左|  0    |
	|  位置 \| 場所 \| トップ |  0.5  |
	|  位置 \| サイズ \| 幅   |  4    |
	|  位置 \| サイズ \| 高さ  |  0.25 |

13. テキスト ボックス テキストの一部を書式設定するには、新しいテキスト ボックス内で**販売注文:** テキストのみを選択します。

	![画像 110](Linked_image_Files/PowerBI_Lab13A_image32.png)

14. 「**ホーム**」 リボン タブの 「**フォント**」 グループ内から、「**太字**」 コマンドをクリックします。

	![画像 56](Linked_image_Files/PowerBI_Lab13A_image33.png)

15. レポート ヘッダー領域に別のテキスト ボックスを追加し、テキスト**リセラー:** の後にスペースを入力します。

	*ヒント: キャンバスを右クリックし、**テキスト ボックスを挿***を | 選択します。

16. スペースの後にプレースホルダーを挿入し、式を使用するようにプレースホルダーの値を設定します。

17. 「**式**」 ウィンドウの 「**カテゴリ**」 の一覧で、「**データセット**」 を選択します。

	![画像 58](Linked_image_Files/PowerBI_Lab13A_image34.png)

18. 式の値を **First(Reseller)** の値に基づいて指定します。

19. 「**プロパティ」** ウィンドウで、次の位置プロパティを構成します。

	|  プロパティ                    |  値|
	|  :---                        |  :--- |
	|  位置 \| 場所 \| 左|  0    |
	|  位置 \| 場所 \| トップ |  0.75 |
	|  位置 \| サイズ \| 幅   |  4    |
	|  位置 \| サイズ \| 高さ  |  0.25 |
	

20. **リセラー:** テキストを太字で書式設定します。

21. レポート ヘッダー領域に 3 番目の (最後の) テキスト ボックスを追加し、テキスト**受注日:** の後にスペースを入力します。

22. スペースの後にプレースホルダーを挿入し、プレースホルダーの値を設定して、「**データセット**」 カテゴリの **First(OrderDate)** の値に基づく式を使用します。

	![画像 111](Linked_image_Files/PowerBI_Lab13A_image35.png)

23. 日付値の書式を設定するには、「**プレースホルダーのプロパティ**」 ウィンドウで 「**数値**」 ページを選択します。

	![画像 61](Linked_image_Files/PowerBI_Lab13A_image36.png)

24. 「**カテゴリ**」 リストで、「**日付**」 を選択します。

	![画像 62](Linked_image_Files/PowerBI_Lab13A_image37.png)

25. 「**種類**」 の一覧で、適切な日付形式を選択します。

26. 「**プレースホルダー プロパティ**」 ウィンドウで、「**OK**」 をクリックします。

27. 「**プロパティ」** ウィンドウで、次の位置プロパティを構成します。

	|  プロパティ                    |  値|
	|  :---                        |  :--- |
	|  位置 \| 場所 \| 左|  0    |
	|  位置 \| 場所 \| トップ |  1    |
	|  位置 \| サイズ \| 幅   |  4    |
	|  位置 \| サイズ \| 高さ  |  0.25 |


28. **発注日** テキストの書式を太字で設定します。

29. 最後に、レポート ヘッダー領域の空白領域をクリックします。

30. 「**プロパティ**」 ペインで、「**高さ**」 プロパティを **1.5** に設定します。

31. レポート ヘッダー領域が次のように表示されることを確認します。

	![画像 112](Linked_image_Files/PowerBI_Lab13A_image38.png)

32. レポートを保存します。

33. レポートをプレビューするには、「**ホーム**」 リボン タブの 「**ビュー**」 グループ内で、「**実行**」 をクリックします。

	![画像 60](Linked_image_Files/PowerBI_Lab13A_image39.png)

	*レポートを実行すると、レポートが HTML 形式でレンダリングされます。レポート パラメーターに既定値が設定されている場合、レポートは自動的に実行されます*。

34. 表示レポートが次のようになっていることを確認します。

	![画像 4](Linked_image_Files/PowerBI_Lab13A_image40.png)

35. デザイン ビューに戻るには、「**実行**」 リボン タブの 「 **ビュー**」 グループ内で、「**デザイン**」 をクリックします。

	![画像 64](Linked_image_Files/PowerBI_Lab13A_image41.png)

	*次に、レポート本文にテーブルを追加して、販売注文明細行の書式付きレイアウトを表示します*。

### タスク 5: テーブル データ領域の追加

このタスクでは、レポート本文にテーブル データ領域を追加します。

1. 「**挿入**」 リボン タブの 「**データ領域**」 グループ内で、「**テーブル**」 をクリックし、「**テーブルの挿入**」 をクリックします。

	![C:\Users\PETERM~1\AppData\Local\Temp\SNAGHTML33b54257.PNG](Linked_image_Files/PowerBI_Lab13A_image42.png)

2. テーブルを追加するには、レポート本文内の空白領域をクリックします。

3. 「**プロパティ」** ウィンドウで、次の位置プロパティを構成します。

	|  プロパティ                     | 値 |
	|  :---                         |  :--- |
	|  位置 \| 場所 \| 左 |  0    |
	|  位置 \| 場所 \| トップ  |  0    |
	
	*テーブルには 5 つの列が表示されます。既定では、テーブル テンプレートには 3 つの列のみが含まれています*。

4. テーブルに列を追加するには、最後の列の任意のセル内を右クリックし、「**列の挿入**」 を選択します。**| 右**。

	![C:\Users\PETERM~1\AppData\Local\Temp\SNAGHTML33b96fbd.PNG](Linked_image_Files/PowerBI_Lab13A_image43.png)

5. 最後の手順を繰り返して、2 つ目の新しい列を追加します。

6. 最初の列の 2 行目のセルにカーソルを合わせると、フィールド ピッカー アイコンが表示されます。

	![画像 67](Linked_image_Files/PowerBI_Lab13A_image44.png)

7. フィールド ピッカー アイコンをクリックし、「**明細行**」 フィールドを選択します。 

	![画像 113](Linked_image_Files/PowerBI_Lab13A_image45.png)

8. テーブルの最初の行 (ヘッダー) にテキスト値が含まれ、詳細行にフィールド参照が含まれていることに注意してください。

	![画像 68](Linked_image_Files/PowerBI_Lab13A_image46.png)

9. 次の 4 つの列に、次の順序でフィールドを追加します。

	* 製品
	* 数量
	* 単価
	* 金額

10. テーブルのデザインが次のようになっていることを確認します。  
	![画像 69](Linked_image_Files/PowerBI_Lab13A_image47.png)

11. レポートを保存します。

12. レポートをレビューします。    
	![画像 71](Linked_image_Files/PowerBI_Lab13A_image48.png)  
	![画像 11](Linked_image_Files/PowerBI_Lab13A_image49.png)  
	*テーブルには、ヘッダーと 12 の販売注文明細行の行が含まれています。テーブル レイアウトを書式設定して、さまざまな機能強化を行うことができます*。   
	*次のタスクでは、次の作業を行います。*
		* 背景色と太字のフォント スタイルを使用して、表の見出しの書式を設定する

		* 列の幅を変更して、余分なスペースを削除し、長いテキスト値が折り返されないようにする

		* 最初の列の値を左揃えにする

		* 最後の 3 つの列の値を右揃えにする

		* 通貨記号を使用して通貨値を書式設定する (USD の場合)

		* テーブルの集計行を追加および書式設定する

### タスク 6: テーブル データ領域を書式設定する

このタスクでは、テーブル データ領域の書式を設定します。

1. デザイン ビューに戻ります。

2. 表内の任意のセルをクリックすると、灰色のセル ガイドが表示されます。  
	![画像 73](Linked_image_Files/PowerBI_Lab13A_image50.png)  
	*行または列全体を構成するためのセル ガイドがあります*。

3. 表の見出しの書式を設定するには、ヘッダー行ガイドをクリックします。  
	![C:\Users\PETERM~1\AppData\Local\Temp\SNAGHTML3426409c.PNG](Linked_image_Files/PowerBI_Lab13A_image51.png)  
	*行または列ガイドを選択すると、その行または列のすべてのセルが選択されます。各セルは、実際にはテキスト ボックスです。単一のテキスト ボックスまたは複数のテキスト ボックスの書式設定は、「**プロパティ**」 ペインまたはリボン コマンドを使用して行うことができます*。

4. 「**プロパティ**」 ウィンドウ (またはリボン) で、次のプロパティを構成します。   

	|  プロパティ         | 値     |
	|  :---------       | :-------  |
	|  塗りつぶし \| BackgroundColor| ダークグリーン (ヒント: 各色の上にカーソルを置くと名前が表示されます) |
	|  フォント \| 色             | 白 |
	|  フォント \| フォント \| FontWeight| 太字 |


5. 最初の列ガイドを選択します。  
	![C:\Users\PETERM~1\AppData\Local\Temp\SNAGHTML342b0187.PNG](Linked_image_Files/PowerBI_Lab13A_image52.png)

6. 「**プロパティ**」 ウィンドウで、「**位置**」 を設定します。**| サイズ |** 「**幅**」 プロパティを **0.5** に設定します。

7. 2 番目の列の幅を **2.5** に設定します。

8. 「**Ctrl**」 キーを押しながら、最後の 3 列ヘッダー テキスト ボックス (**数量**、 **単価**、 および **金額**) を複数選択します。    

9. 「**プロパティ**」 ウィンドウ (またはリボン) で、「**位置合わせ | テキスト配置**」 プロパティを 「**右**」 に設定します。

10. 「**明細行**」 詳細テキストボックスを左揃えに設定します。  
	![C:\Users\PETERM~1\AppData\Local\Temp\SNAGHTML342fbe1d.PNG](Linked_image_Files/PowerBI_Lab13A_image53.png)

11. 「**ホーム**」 リボン タブの 「**番号**」 グループ内から、最後の 2 つの詳細 (ヘッダーではない) テキスト ボックス (**単価**と **金額**) を通貨記号で書式設定します。  
	![画像 77](Linked_image_Files/PowerBI_Lab13A_image54.png)

12. テーブルに集計行を追加するには、「**数量**」 の詳細テキスト ボックスを右クリックし、「**合計の追加**」 を選択します。     
	![画像 78](Linked_image_Files/PowerBI_Lab13A_image55.png)

13. テーブルのフッターを表す新しい行が追加され、式によって**数量**値の合計が評価されることに注意してください。

14. 「**金額**」 の詳細テキスト ボックスに合計を追加するには、最後の手順を繰り返します。

15. 表のフッター行の最初のセルに、「**合計**」という語を入力します。

16. フッター行のすべてのテキストボックスを太字に設定します。

17. テーブルのデザインが次のようになっていることを確認します。  
	![画像 79](Linked_image_Files/PowerBI_Lab13A_image56.png)

18. テーブルの後の後続スペースをすべて削除するには、レポート本文とレポート フッター領域の間の破線上にカーソルを置き、上方向にドラッグしてテーブルの下部に移動します。  
	![画像 84](Linked_image_Files/PowerBI_Lab13A_image57.png)

19. レポートを保存する

20. レポートをレビューします。

21. 表示レポートが次のようになっていることを確認します。  
	![画像 6](Linked_image_Files/PowerBI_Lab13A_image58.png)

22. 「**販売注文番号**」 パラメーター ボックスで、値を **51721** に置き換えます。   
	![画像 81](Linked_image_Files/PowerBI_Lab13A_image59.png)

23. レポートを再実行するには、右側の 「**レポートの表示**」 をクリックします。   
	![画像 82](Linked_image_Files/PowerBI_Lab13A_image60.png)  
	*この販売注文には 72 の販売注文明細行があるため、データは多くのページにレンダリングされます*。

24. レポートの 2 ページ目に移動するには、「**実行**」 リボン タブの 「**ナビゲーション**」 グループ内から、「**次へ**」 をクリックします。  
	![画像 83](Linked_image_Files/PowerBI_Lab13A_image61.png)

25. 2 ページ目で、表の見出しが表示されないことに注意してください。  
	*次のタスクでは、この問題を扱います*。

26. ページの一番下までスクロールすると、レポート フッターに実行時間のみが表示されます。  
	*次のタスクでは、 ページ番号を追加してフッター テキストを改善します*。

### タスク 7: レポートのデザインを完成する

このタスクでは、複数ページのレポートを適切に表示して、レポートのデザインを完成させます。

1. デザイン ビューに切り替えます。

2. すべてのページで表の見出しを繰り返し表示するには、まずテーブルの任意のテキスト ボックスを選択します。

3. 「**グループ化**」 ペイン (レポート デザイナーの下部) の 「**列グループ**」 の右端にある下向き矢印をクリックし、「**詳細モード**」 を選択します。       
	![C:\Users\PETERM~1\AppData\Local\Temp\SNAGHTML34447bde.PNG](Linked_image_Files/PowerBI_Lab13A_image62.png)
4. 「**リソース グループ**」 セクションで、最初の静的グループを選択します。  
	![画像 86](Linked_image_Files/PowerBI_Lab13A_image63.png)  
	*これにより、表の見出し行が選択されました*。

5. 「**プロパティ**」 ペインで、「**その他**」 を設定します **|** 「**RepeatOnNewPage**」 プロパティを 「**True**」 に変更します。  
	*これにより、テーブル ヘッダーを表す最初の静的グループがすべてのページで繰り返されます*。

6. テーブル フッター領域で、「**実行時間**」 テキスト ボックスを右クリックし、「**式**」 を選択します。  
	![C:\Users\PETERM~1\AppData\Local\Temp\SNAGHTML34484edf.PNG](Linked_image_Files/PowerBI_Lab13A_image64.png)

7. 「**式**」 ウィンドウの 「式」 ボックスにスペースを追加し、その後に **&amp; “**を続けます** | ページ “ &amp;** をクリックして、次の項目を生成します。  
**VB スクリプト**
	```
	=Globals!ExecutionTime & " | Page " &
	```

8. 最後のアンパサンド (&) の後にスペースを入れてください。

9. 「**カテゴリ**」 リストで、「**組み込みフィールド**」 を選択します。  
	![画像 94](Linked_image_Files/PowerBI_Lab13A_image65.png)

10 ページ番号の値を式に挿入するには、「**項目**」 リストで、「**ページ番号**」 をダブルクリックします。

11 式全体が次のように表示されていることを確認します。  
	![画像 114](Linked_image_Files/PowerBI_Lab13A_image66.png)

12. 「**OK**」 をクリックします。

13. テキスト ボックスの左側をドラッグして、幅をレポート ページの幅まで拡大します。  
	![画像 104](Linked_image_Files/PowerBI_Lab13A_image67.png)  
	*これで、レポートのデザインが完了しました。最後に、ページ幅が正確に 6 インチに設定されていることを確認し、レポート パラメーターの既定値も削除します*。

14. レポートの本文を選択するには、任意のテーブルのテキスト ボックスを右クリックして、「**選択 | 本文**」 を選択します。  
	![C:\Users\PETERM~1\AppData\Local\Temp\SNAGHTML34507b38.PNG](Linked_image_Files/PowerBI_Lab13A_image68.png)  
	*テーブルがレポート本文全体に表示されるように、この手法を使用してレポート本文を選択する必要があります*。

15. 「**プロパティ**」 ウィンドウで、「**位置 | サイズ | 幅**」 プロパティは **6** に設定されていることを確認します。  
	*印刷形式のレンダリングでは複数のページにわたって表が分割されるので、幅を 6 インチ以下にすることが重要です*。

16. 「**レポート データ**」 ウィンドウで、「**SalesOrderNumber**」 レポート パラメーターのプロパティを開きます。

17. 「**既定値**」 ページで、「**既定値なし**」 オプションを選択します。  
	![画像 98](Linked_image_Files/PowerBI_Lab13A_image69.png)

18. 「**OK**」 をクリックします。

19. レポートを保存します。

### **タスク 8: 最終レポートを確認する**

このタスクでは、印刷レイアウト モードでレポートを表示します。

1. レポートをレビューします。

2. 「**販売注文番号**」 パラメーター ボックスに、**51721** の値を入力します。

3. 「**実行**」 リボン タブの 「**印刷**」 グループの 「**印刷レイアウト**」 をクリックします。  
	![画像 7](Linked_image_Files/PowerBI_Lab13A_image70.png)  
	*印刷レイアウト モードでは、厳密なページ サイズ に印刷したときのレポートのプレビューが表示されます*。

4. ページ 2 と 3 に移動します。  
	*このラボでは、レポートを公開しません。改ページ調整されたレポートは、専用容量のワークスペースに格納されている場合、およびその容量でページ分割されたレポートのワークロードが有効になっている場合にのみ、Power BI サービスで表示できます。これらの要件は、クラス には存在しません*。
